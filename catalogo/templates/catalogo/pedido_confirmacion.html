{% extends "base.html" %}
{% load static %}

{% block title %}Pedido {{ pedido.codigo }} confirmado · Pure Warer{% endblock %}

{% block content %}

<div class="pedido-wrapper">

  <!-- Hero de confirmación -->
  <div class="pedido-hero">
    <div class="hero-left">
      <p class="pedido-hero-tag">Pedido confirmado</p>
      <h1 class="mb-2">¡Gracias por tu compra, {{ pedido.nombre_completo }}!</h1>
      <p class="pedido-hero-desc mb-2">
        Tu código de pedido es:
        <strong>{{ pedido.codigo }}</strong>.
      </p>
      <p class="pedido-hero-desc mb-0">
        Guárdalo para rastrear el estado de tu envío en cualquier momento.
      </p>

      <div class="mt-3 d-flex flex-wrap gap-2">
        <a href="{% url 'trackear_pedido' %}" class="btn btn-light btn-sm">
        Rastrear mi pedido
      </a>
        <a href="{% url 'lista_productos' %}" class="btn btn-outline-light btn-sm">
          Seguir comprando
        </a>
      </div>
    </div>

    <div class="hero-logo d-none d-md-flex">
      <i class="bi bi-bag-check-fill" style="font-size: 3.2rem;"></i>
    </div>
  </div>

  <!-- Contenido inferior -->
  <div class="row mt-4 g-4">
    <!-- Resumen de productos -->
    <div class="col-lg-7">
      <div class="card pedido-card shadow-sm">
        <div class="card-body">
          <h5 class="card-title mb-3">Resumen de tu pedido</h5>

          <ul class="list-group mb-3 checkout-items">
            {% for item in items %}
              <li class="list-group-item d-flex justify-content-between align-items-start">
                <div class="me-3">
                  <div class="fw-semibold">
                    {{ item.producto.nombre }}
                    {% if item.talla %}
                      <span class="badge bg-light text-dark ms-1">Talla {{ item.talla }}</span>
                    {% endif %}
                  </div>
                  <small class="text-muted">
                    Cantidad: {{ item.cantidad }} · ${{ item.precio_unitario }} c/u
                  </small>
                </div>
                <span class="fw-bold">
                  ${{ item.subtotal }}
                </span>
              </li>
            {% empty %}
              <li class="list-group-item">
                No se encontraron productos en este pedido.
              </li>
            {% endfor %}
          </ul>

          <div class="d-flex justify-content-between align-items-center mt-2">
            <span class="fw-semibold">Total pagado:</span>
            <span class="fs-5 fw-bold text-success">${{ total_pedido }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Datos de envío y estado -->
    <div class="col-lg-5">
      <div class="card pedido-card shadow-sm">
        <div class="card-body">
          <h5 class="card-title mb-3">Datos de envío</h5>

          <p class="mb-1 fw-semibold">{{ pedido.nombre_completo }}</p>
          <p class="mb-1">{{ pedido.direccion }}</p>
          <p class="mb-1">
            {{ pedido.ciudad }}, {{ pedido.estado }} · CP {{ pedido.codigo_postal }}
          </p>
          <p class="mb-1">
            <i class="bi bi-telephone"></i> {{ pedido.telefono }}
          </p>
          <p class="mb-3">
            <i class="bi bi-envelope"></i> {{ pedido.email }}
          </p>

          <div class="border-top pt-3 mt-2">
            <p class="mb-1 small text-muted">Estado actual del pedido:</p>
            <span class="badge bg-primary">
              {{ pedido.get_estado_pedido_display }}
            </span>
          </div>

          <div class="mt-3">
            <a href="{% url 'detalle_pedido' pedido.id %}" class="btn btn-dark btn-sm">
              Ver detalles completos
            </a>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

{% endblock %}
